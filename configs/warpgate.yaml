listeners:
  - name: http
    address: ":8080"
    tls:
      enabled: false
    redirectTo: "https"     # redirect all HTTP traffic to this listener

  - name: https
    address: ":8443"
    tls:
      enabled: true
      certFile: "cert.pem"
      keyFile: "key.pem"

cache:
  maxEntries: 1000
  defaultTTL: 30s
  maxBodyBytes: 1048576

clusters:
- name: demo_cluster
  endpoint:
    - "https://172.17.0.2"
    - "https://172.17.0.3"
  healthCheck:
    path: "/health"
    interval: 5s
    timeout: 1s
    unhealthyThreshold: 3
    healthyThreshold: 2
  circuitBreaker:
    consecutiveFailures: 5
    cooldown: 30s

- name: api_cluster
  endpoints:
  - "https://localhost:9000"


routes:
  - name: demo
    pathPrefix: "/"
    cluster: "demo_cluster"
    cache:
      enabled: true
      ttl: 10s

  - name: api
    pathPrefix: "/api"
    cluster: "api_cluster"
    cache:
      enabled: false
